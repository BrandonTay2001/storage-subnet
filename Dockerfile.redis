FROM redis:latest

ARG REDIS_CONF
ENV REDIS_CONF=$REDIS_CONF

RUN useradd -s /bin/bash redis
USER redis

RUN mkdir /etc/redis/ && \
    mkdir /var/log/redis/ && \
    mkdir /var/lib/redis/

COPY $REDIS_CONF /etc/redis/

RUN chown redis /etc/redis/redis.conf && \
    chgrp redis /etc/redis/redis.conf && \
    chown -R redis:redis /var/log/redis/ && \
    chown -R redis:redis /var/lib/redis/